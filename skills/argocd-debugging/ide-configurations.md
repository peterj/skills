# IDE Launch Configurations for Argo CD Debugging

## Table of Contents
- [VSCode — Local Debugging](#vscode--local-debugging)
- [GoLand — Local Debugging](#goland--local-debugging)
- [VSCode — Remote Debugging (Telepresence)](#vscode--remote-debugging-telepresence)

## VSCode — Local Debugging

Add to `.vscode/launch.json`:

```json
{
  "name": "api-server",
  "type": "go",
  "request": "launch",
  "mode": "auto",
  "program": "YOUR_CLONED_ARGO_CD_REPO_PATH/argo-cd/cmd",
  "args": [
    "--loglevel",
    "debug",
    "--redis",
    "localhost:6379",
    "--repo-server",
    "localhost:8081",
    "--dex-server",
    "http://localhost:5556",
    "--port",
    "8080",
    "--insecure"
  ],
  "envFile": "YOUR_ENV_FILES_PATH/api-server.env"
}
```

- Replace `YOUR_CLONED_ARGO_CD_REPO_PATH` with the actual repo path.
- Replace `YOUR_ENV_FILES_PATH` with the path to your env file.
- Requires the **DotENV** plugin.
- Copy args from the Procfile (after `$COMMAND`).

## GoLand — Local Debugging

Import or create a Run/Debug Configuration. The XML configuration:

```xml
<component name="ProjectRunConfigurationManager">
  <configuration default="false" name="api-server" type="GoApplicationRunConfiguration" factoryName="Go Application">
    <module name="argo-cd" />
    <working_directory value="$PROJECT_DIR$" />
    <parameters value="--loglevel debug --redis localhost:6379 --insecure --dex-server http://localhost:5556 --repo-server localhost:8081 --port 8080" />
    <EXTENSION ID="net.ashald.envfile">
      <option name="IS_ENABLED" value="true" />
      <option name="IS_SUBST" value="false" />
      <option name="IS_PATH_MACRO_SUPPORTED" value="false" />
      <option name="IS_IGNORE_MISSING_FILES" value="false" />
      <option name="IS_ENABLE_EXPERIMENTAL_INTEGRATIONS" value="false" />
      <ENTRIES>
        <ENTRY IS_ENABLED="true" PARSER="runconfig" IS_EXECUTABLE="false" />
        <ENTRY IS_ENABLED="true" PARSER="env" IS_EXECUTABLE="false" PATH="<YOUR_ENV_FILES_PATH>/api-server.env" />
      </ENTRIES>
    </EXTENSION>
    <kind value="DIRECTORY" />
    <directory value="$PROJECT_DIR$/cmd" />
    <filePath value="$PROJECT_DIR$" />
    <method v="2" />
  </configuration>
</component>
```

- Requires the **EnvFile** plugin (`net.ashald.envfile`).
- Alternative: create via GoLand's Run/Debug Configuration wizard (Run kind: `Directory`), then set `parameters`, `directory`, and env file `PATH` from the example above.

## VSCode — Remote Debugging (Telepresence)

After running `telepresence intercept` with `--env-file .envrc.remote`:

```json
{
  "name": "Launch argocd-server",
  "type": "go",
  "request": "launch",
  "mode": "auto",
  "program": "${workspaceFolder}/cmd/main.go",
  "envFile": [
    "${workspaceFolder}/.envrc.remote"
  ],
  "env": {
    "ARGOCD_BINARY_NAME": "argocd-server",
    "CGO_ENABLED": "0",
    "KUBECONFIG": "/path/to/kube/config"
  }
}
```

- The `.envrc.remote` file is generated by Telepresence and contains all remote pod environment variables.
- Set `KUBECONFIG` to your local kubeconfig path.
- `CGO_ENABLED=0` ensures a static build.
